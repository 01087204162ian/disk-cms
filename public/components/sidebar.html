<!-- 현대화된 사이드바 - Tabler 기반 -->
<aside class="navbar navbar-vertical navbar-expand-lg" data-bs-theme="dark">
  <div class="container-fluid">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#sidebar-menu" aria-controls="sidebar-menu" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    
    <!-- 브랜드 로고 -->
    <h1 class="navbar-brand navbar-brand-autodark">
      <a href="#" onclick="window.modernTemplateLoader.navigateToPage('dashboard')">
        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzIiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTEyIDJMMTMuMDkgOC4yNkwyMCA5TDEzLjA5IDE1Ljc0TDEyIDIyTDEwLjkxIDE1Ljc0TDQgOUwxMC45MSA4LjI2TDEyIDJaIiBmaWxsPSIjZmZmZmZmIi8+Cjwvc3ZnPgo=" alt="보험 CMS">
        보험 CMS
      </a>
    </h1>

    <!-- 동적 메뉴 영역 -->
    <div class="collapse navbar-collapse" id="sidebar-menu">
      <ul class="navbar-nav pt-lg-3" id="dynamic-menu">
        <!-- 메뉴는 JavaScript로 동적 생성됩니다 -->
      </ul>
    </div>
  </div>
</aside>

<script>
/**
 * 동적 메뉴 생성 함수
 * template-loader.js의 menuConfig를 기반으로 메뉴를 동적 생성
 */
function generateDynamicMenu() {
  if (!window.modernTemplateLoader) {
    setTimeout(generateDynamicMenu, 100);
    return;
  }

  const menuContainer = document.getElementById('dynamic-menu');
  if (!menuContainer) return;

  const menuConfig = window.modernTemplateLoader.menuConfig;
  if (!menuConfig) return;

  // 메뉴 그룹화
  const menuGroups = {
    main: [],
    insurance: [],
    attendance: [],
    work: [],
    leave: [],
    admin: [],
    reports: [],
    other: []
  };

  // 메뉴 분류
  Object.entries(menuConfig).forEach(([pageId, config]) => {
    const menuItem = { pageId, ...config };
    
    if (pageId === 'dashboard') {
      menuGroups.main.push(menuItem);
    } else if (config.category === 'insurance') {
      menuGroups.insurance.push(menuItem);
    } else if (config.category === 'attendance') {
      menuGroups.attendance.push(menuItem);
    } else if (config.category === 'work') {
      menuGroups.work.push(menuItem);
    } else if (config.category === 'leave') {
      menuGroups.leave.push(menuItem);
    } else if (config.category === 'admin') {
      menuGroups.admin.push(menuItem);
    } else if (config.category === 'reports') {
      menuGroups.reports.push(menuItem);
    } else {
      menuGroups.other.push(menuItem);
    }
  });

  let menuHTML = '';

  // 대시보드 (메인)
  menuGroups.main.forEach(item => {
    menuHTML += `
      <li class="nav-item">
        <a class="nav-link" href="#" onclick="window.modernTemplateLoader.navigateToPage('${item.pageId}')" data-menu="${item.pageId}">
          <span class="nav-link-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
              <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
              <rect x="4" y="4" width="6" height="5" rx="1"/>
              <rect x="4" y="13" width="6" height="7" rx="1"/>
              <rect x="14" y="4" width="6" height="16" rx="1"/>
            </svg>
          </span>
          <span class="nav-link-title">${item.title}</span>
        </a>
      </li>`;
  });

  // 보험 업무 관리
  if (menuGroups.insurance.length > 0) {
    menuHTML += `
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#navbar-insurance" data-bs-toggle="dropdown" data-menu="insurance" role="button" aria-expanded="false">
          <span class="nav-link-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
              <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
              <path d="M12 3a12 12 0 0 0 8.5 3a12 12 0 0 1 -8.5 15a12 12 0 0 1 -8.5 -15a12 12 0 0 0 8.5 -3"/>
            </svg>
          </span>
          <span class="nav-link-title">보험 업무 관리</span>
        </a>
        <div class="dropdown-menu">
          <div class="dropdown-menu-columns">
            <div class="dropdown-menu-column">`;
    
    menuGroups.insurance.forEach(item => {
      menuHTML += `
        <a class="dropdown-item" href="#" onclick="window.modernTemplateLoader.navigateToPage('${item.pageId}')" data-menu="${item.pageId}">${item.title}</a>`;
    });
    
    menuHTML += `
            </div>
          </div>
        </div>
      </li>`;
  }

  // 출퇴근 관리
  if (menuGroups.attendance.length > 0) {
    menuHTML += `
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#navbar-attendance" data-bs-toggle="dropdown" data-menu="attendance" role="button" aria-expanded="false">
          <span class="nav-link-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
              <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
              <circle cx="12" cy="12" r="9"/>
              <polyline points="12,7 12,12 15,15"/>
            </svg>
          </span>
          <span class="nav-link-title">출퇴근 관리</span>
        </a>
        <div class="dropdown-menu">
          <div class="dropdown-menu-columns">
            <div class="dropdown-menu-column">`;
    
    menuGroups.attendance.forEach(item => {
      menuHTML += `
        <a class="dropdown-item" href="#" onclick="window.modernTemplateLoader.navigateToPage('${item.pageId}')" data-menu="${item.pageId}">${item.title}</a>`;
    });
    
    menuHTML += `
            </div>
          </div>
        </div>
      </li>`;
  }

  // 업무 관리
  if (menuGroups.work.length > 0) {
    menuHTML += `
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#navbar-work" data-bs-toggle="dropdown" data-menu="work" role="button" aria-expanded="false">
          <span class="nav-link-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
              <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
              <rect x="4" y="4" width="6" height="6" rx="1"/>
              <rect x="14" y="4" width="6" height="6" rx="1"/>
              <rect x="4" y="14" width="6" height="6" rx="1"/>
              <rect x="17" y="17" width="2" height="2" rx="1"/>
              <rect x="17" y="14" width="2" height="2" rx="1"/>
              <rect x="14" y="17" width="2" height="2" rx="1"/>
            </svg>
          </span>
          <span class="nav-link-title">업무 관리</span>
        </a>
        <div class="dropdown-menu">
          <div class="dropdown-menu-columns">
            <div class="dropdown-menu-column">`;
    
    menuGroups.work.forEach(item => {
      menuHTML += `
        <a class="dropdown-item" href="#" onclick="window.modernTemplateLoader.navigateToPage('${item.pageId}')" data-menu="${item.pageId}">${item.title}</a>`;
    });
    
    menuHTML += `
            </div>
          </div>
        </div>
      </li>`;
  }

  // 휴가 관리
  if (menuGroups.leave.length > 0) {
    menuHTML += `
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#navbar-leave" data-bs-toggle="dropdown" data-menu="leave" role="button" aria-expanded="false">
          <span class="nav-link-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
              <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
              <rect x="4" y="5" width="16" height="16" rx="2"/>
              <line x1="16" y1="3" x2="16" y2="7"/>
              <line x1="8" y1="3" x2="8" y2="7"/>
              <line x1="4" y1="11" x2="20" y2="11"/>
            </svg>
          </span>
          <span class="nav-link-title">휴가 관리</span>
        </a>
        <div class="dropdown-menu">
          <div class="dropdown-menu-columns">
            <div class="dropdown-menu-column">`;
    
    menuGroups.leave.forEach(item => {
      menuHTML += `
        <a class="dropdown-item" href="#" onclick="window.modernTemplateLoader.navigateToPage('${item.pageId}')" data-menu="${item.pageId}">${item.title}</a>`;
    });
    
    menuHTML += `
            </div>
          </div>
        </div>
      </li>`;
  }

  // 관리 구분선
  if (menuGroups.admin.length > 0 || menuGroups.reports.length > 0) {
    menuHTML += `
      <li class="nav-item">
        <div class="hr-text">관리</div>
      </li>`;
  }

  // 사용자 관리 (관리자 전용)
  if (menuGroups.admin.length > 0) {
    menuHTML += `
      <li class="nav-item admin-only dropdown">
        <a class="nav-link dropdown-toggle" href="#navbar-users" data-bs-toggle="dropdown" data-menu="users" role="button" aria-expanded="false">
          <span class="nav-link-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
              <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
              <circle cx="9" cy="7" r="4"/>
              <path d="M3 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2"/>
              <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
              <path d="M21 21v-2a4 4 0 0 0 -3 -3.85"/>
            </svg>
          </span>
          <span class="nav-link-title">사용자 관리</span>
        </a>
        <div class="dropdown-menu">
          <div class="dropdown-menu-columns">
            <div class="dropdown-menu-column">`;
    
    menuGroups.admin.forEach(item => {
      menuHTML += `
        <a class="dropdown-item" href="#" onclick="window.modernTemplateLoader.navigateToPage('${item.pageId}')" data-menu="${item.pageId}">${item.title}</a>`;
    });
    
    menuHTML += `
            </div>
          </div>
        </div>
      </li>`;
  }

  // 보고서 (관리자 전용)
  if (menuGroups.reports.length > 0) {
    menuHTML += `
      <li class="nav-item admin-only dropdown">
        <a class="nav-link dropdown-toggle" href="#navbar-reports" data-bs-toggle="dropdown" data-menu="reports" role="button" aria-expanded="false">
          <span class="nav-link-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
              <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
              <polyline points="22,12 18,12 15,21 9,3 6,12 2,12"/>
            </svg>
          </span>
          <span class="nav-link-title">보고서</span>
        </a>
        <div class="dropdown-menu">
          <div class="dropdown-menu-columns">
            <div class="dropdown-menu-column">`;
    
    menuGroups.reports.forEach(item => {
      menuHTML += `
        <a class="dropdown-item" href="#" onclick="window.modernTemplateLoader.navigateToPage('${item.pageId}')" data-menu="${item.pageId}">${item.title}</a>`;
    });
    
    menuHTML += `
            </div>
          </div>
        </div>
      </li>`;
  }

  // 기타 메뉴들
  if (menuGroups.other.length > 0) {
    menuHTML += `
      <li class="nav-item">
        <div class="hr-text">기타</div>
      </li>`;
    
    menuGroups.other.forEach(item => {
      const iconSvg = getMenuIcon(item.pageId);
      menuHTML += `
        <li class="nav-item">
          <a class="nav-link" href="#" onclick="window.modernTemplateLoader.navigateToPage('${item.pageId}')" data-menu="${item.pageId}">
            <span class="nav-link-icon">
              ${iconSvg}
            </span>
            <span class="nav-link-title">${item.title}</span>
          </a>
        </li>`;
    });
  }

  menuContainer.innerHTML = menuHTML;
}

/**
 * 메뉴 아이콘 반환 함수
 */
function getMenuIcon(pageId) {
  const icons = {
    'announcements': `
      <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
        <path d="M10 14a3.5 3.5 0 0 0 5 0l4 -4a3.5 3.5 0 0 0 -5 -5l-.5 .5"/>
        <path d="M14 10a3.5 3.5 0 0 0 -5 0l-4 4a3.5 3.5 0 0 0 5 5l.5 -.5"/>
      </svg>`,
    'help': `
      <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
        <circle cx="12" cy="12" r="9"/>
        <path d="M12 8h.01"/>
        <path d="M11 12h1v4h1"/>
      </svg>`,
    'system-settings': `
      <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
        <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
        <path d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 0 0 -1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 0 0 -2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 0 0 -2.573 -1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 0 0 1.066 -2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/>
        <circle cx="12" cy="12" r="3"/>
      </svg>`
  };

  return icons[pageId] || `
    <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9"/>
    </svg>`;
}

// DOM이 로드되면 메뉴 생성
document.addEventListener('DOMContentLoaded', generateDynamicMenu);
</script>