# 주4일 근무제 시스템 테스트 시나리오

## 목차
1. [테스트 환경 설정](#테스트-환경-설정)
2. [기본 기능 테스트](#기본-기능-테스트)
3. [공휴일 처리 테스트](#공휴일-처리-테스트)
4. [반차 신청 테스트](#반차-신청-테스트)
5. [일시적 휴무일 변경 테스트](#일시적-휴무일-변경-테스트)
6. [시 probation 기간 테스트](#시-probation-기간-테스트)
7. [타임존 및 날짜 계산 테스트](#타임존-및-날짜-계산-테스트)
8. [에러 케이스 테스트](#에러-케이스-테스트)

---

## 테스트 환경 설정

### 테스트 사용자 정보
- **이메일**: `sj2@simg.kr`
- **이름**: 테스트
- **입사일**: 설정 필요 (probation 테스트용)
- **기본 휴무일**: 금요일 (5)
- **주기 시작일**: 2025-01-06 (월요일)

### 초기 데이터 설정
```sql
-- 테스트 전 데이터 초기화
UPDATE users
SET work_days = JSON_OBJECT(
    'base_off_day', 5,
    'cycle_start_date', '2025-01-06',
    'initial_selection_date', '2025-01-06'
)
WHERE email = 'sj2@simg.kr';
```

### 테스트 도구
- 브라우저: Chrome/Edge (개발자 도구 활성화)
- API 테스트: Postman 또는 브라우저 개발자 도구 Network 탭
- 데이터베이스: MySQL/MariaDB 클라이언트

---

## 기본 기능 테스트

### TC-001: 기본 휴무일 표시 확인
**목적**: 사용자의 기본 휴무일이 올바르게 표시되는지 확인

**전제 조건**:
- 사용자 로그인 완료
- `work_days` 데이터가 올바르게 설정됨

**테스트 단계**:
1. `/pages/staff/employee-schedule.html` 페이지 접속
2. 2025년 1월 달력 확인
3. "기본 휴무일" 섹션에서 "금요일" 표시 확인
4. "이번 달 근무 패턴" 섹션에서 휴무일 확인

**예상 결과**:
- ✅ 기본 휴무일: 금요일
- ✅ 2025년 1월 1주차: 금요일 휴무
- ✅ 캘린더에서 금요일이 "휴무일"로 표시됨

**실제 결과**: 
- [ ] 통과
- [ ] 실패 (비고: _______________)

---

### TC-002: 4주 주기 순환 확인
**목적**: 4주 주기로 휴무일이 역순으로 순환하는지 확인

**전제 조건**:
- `base_off_day`: 5 (금요일)
- `cycle_start_date`: 2025-01-06

**테스트 단계**:
1. 2025년 1월 달력 확인
   - 1주차 (1/6~1/10): 금요일 휴무 예상
2. 2025년 2월 달력 확인
   - 5주차 (2/3~2/7): 목요일 휴무 예상 (금→목)
3. 2025년 3월 달력 확인
   - 9주차 (3/3~3/7): 수요일 휴무 예상 (목→수)
4. 2025년 4월 달력 확인
   - 13주차 (4/7~4/11): 화요일 휴무 예상 (수→화)
5. 2025년 5월 달력 확인
   - 17주차 (5/5~5/9): 월요일 휴무 예상 (화→월)
6. 2025년 6월 달력 확인
   - 21주차 (6/2~6/6): 금요일 휴무 예상 (월→금, 순환 완료)

**예상 결과**:
- ✅ 각 주차별 휴무일이 예상대로 표시됨
- ✅ 순환 방향: 금→목→수→화→월→금 (역순)
- ✅ 4주 주기로 정확히 순환

**실제 결과**: 
- [ ] 통과
- [ ] 실패 (비고: _______________)

---

### TC-003: 주차 정보 표시 확인
**목적**: 현재 주차 정보가 올바르게 표시되는지 확인

**테스트 단계**:
1. 각 월별로 페이지 접속
2. "주차 정보" 배지 확인
3. "주차 범위" 표시 확인 (예: "1-4주차", "5-8주차")

**예상 결과**:
- ✅ 주차 정보가 올바르게 표시됨
- ✅ 주차 범위가 정확함 (4주 단위)

**실제 결과**: 
- [ ] 통과
- [ ] 실패 (비고: _______________)

---

## 공휴일 처리 테스트

### TC-004: 공휴일 표시 확인
**목적**: 공휴일이 캘린더에 올바르게 표시되는지 확인

**전제 조건**:
- `holidays` 테이블에 2025년 공휴일 데이터 존재

**테스트 단계**:
1. 2025년 12월 달력 확인
2. 12월 25일 (크리스마스) 확인
3. 다른 공휴일들도 확인

**예상 결과**:
- ✅ 공휴일이 "공휴일"로 표시됨
- ✅ 공휴일은 휴무일과 구분되어 표시됨

**실제 결과**: 
- [ ] 통과
- [ ] 실패 (비고: _______________)

---

### TC-005: 공휴일 포함 주의 휴무일 취소
**목적**: 주중에 공휴일이 있는 주의 휴무일이 취소되는지 확인

**전제 조건**:
- 2025년 12월 21일~27일 주에 12월 25일 (크리스마스) 공휴일 포함

**테스트 단계**:
1. 2025년 12월 달력 확인
2. 12월 21일~27일 주 확인
3. 해당 주의 휴무일 확인 (원래는 금요일이어야 함)

**예상 결과**:
- ✅ 12월 25일이 "공휴일"로 표시됨
- ✅ 해당 주의 금요일(12월 27일)이 "근무일"로 표시됨 (휴무일 취소)
- ✅ "공휴일 포함 주" 알림 표시됨

**실제 결과**: 
- [ ] 통과
- [ ] 실패 (비고: _______________)

---

### TC-006: 공휴일이 없는 주의 정상 휴무일
**목적**: 공휴일이 없는 주는 정상적으로 휴무일이 표시되는지 확인

**테스트 단계**:
1. 공휴일이 없는 주 선택 (예: 2025년 1월 첫째 주)
2. 해당 주의 휴무일 확인

**예상 결과**:
- ✅ 휴무일이 정상적으로 "휴무일"로 표시됨
- ✅ 공휴일 알림이 표시되지 않음

**실제 결과**: 
- [ ] 통과
- [ ] 실패 (비고: _______________)

---

## 반차 신청 테스트

### TC-007: 같은 주 내 반차 신청 (성공)
**목적**: 같은 주 내에서 반차 신청이 성공하는지 확인

**전제 조건**:
- 사용자가 probation 기간이 아님
- 해당 주에 공휴일이 없음

**테스트 단계**:
1. "반차 신청" 버튼 클릭
2. 반차 신청 모달에서:
   - 날짜 선택 (현재 주의 평일)
   - 오전/오후 선택
   - 사유 입력
3. "신청하기" 버튼 클릭

**예상 결과**:
- ✅ 반차 신청 성공
- ✅ 캘린더에 해당 날짜가 "오전반차" 또는 "오후반차"로 표시됨
- ✅ 성공 메시지 표시

**실제 결과**: 
- [ ] 통과
- [ ] 실패 (비고: _______________)

---

### TC-008: 다른 주 반차 신청 (실패)
**목적**: 다른 주의 날짜로 반차 신청 시 검증 오류가 발생하는지 확인

**테스트 단계**:
1. "반차 신청" 버튼 클릭
2. 반차 신청 모달에서:
   - 다른 주의 날짜 선택 (현재 주가 아닌 날짜)
   - 오전/오후 선택
   - 사유 입력
3. "신청하기" 버튼 클릭

**예상 결과**:
- ✅ 검증 오류 메시지 표시: "반차는 같은 주(월~일) 내에서만 사용 가능합니다."
   - 또는 "반차는 해당 주의 휴무일과 같은 주에만 신청 가능합니다."
- ✅ 반차 신청이 거부됨

**실제 결과**: 
- [ ] 통과
- [ ] 실패 (비고: _______________)

---

### TC-009: 휴무일에 반차 신청 (실패)
**목적**: 휴무일에 반차 신청 시 검증 오류가 발생하는지 확인

**테스트 단계**:
1. 현재 주의 휴무일 확인
2. "반차 신청" 버튼 클릭
3. 반차 신청 모달에서:
   - 휴무일 날짜 선택
   - 오전/오후 선택
   - 사유 입력
4. "신청하기" 버튼 클릭

**예상 결과**:
- ✅ 검증 오류 메시지 표시
- ✅ 반차 신청이 거부됨

**실제 결과**: 
- [ ] 통과
- [ ] 실패 (비고: _______________)

---

### TC-010: 공휴일에 반차 신청 (실패)
**목적**: 공휴일에 반차 신청 시 검증 오류가 발생하는지 확인

**테스트 단계**:
1. 공휴일이 있는 달 선택 (예: 2025년 12월)
2. "반차 신청" 버튼 클릭
3. 반차 신청 모달에서:
   - 공휴일 날짜 선택 (예: 12월 25일)
   - 오전/오후 선택
   - 사유 입력
4. "신청하기" 버튼 클릭

**예상 결과**:
- ✅ 검증 오류 메시지 표시
- ✅ 반차 신청이 거부됨

**실제 결과**: 
- [ ] 통과
- [ ] 실패 (비고: _______________)

---

## 일시적 휴무일 변경 테스트

### TC-011: 일시적 휴무일 변경 신청 (성공)
**목적**: 일시적 휴무일 변경 신청이 성공하는지 확인

**전제 조건**:
- 사용자가 probation 기간이 아님
- 해당 주에 공휴일이 없음

**테스트 단계**:
1. "휴무일 일시적 변경" 버튼 클릭
2. 일시적 변경 모달에서:
   - 주 시작일 확인 (자동 입력)
   - 원래 휴무일 확인 (자동 입력)
   - 임시 휴무일 선택 (다른 요일)
   - 대체 직원 선택 (선택사항)
   - 변경 사유 입력
3. "신청하기" 버튼 클릭

**예상 결과**:
- ✅ 일시적 변경 신청 성공
- ✅ 성공 메시지 표시
- ✅ 해당 주의 캘린더에 변경된 휴무일이 표시됨

**실제 결과**: 
- [ ] 통과
- [ ] 실패 (비고: _______________)

---

### TC-012: 일시적 휴무일 변경 검증 (원래 휴무일과 동일)
**목적**: 원래 휴무일과 동일한 날짜로 변경 시 검증 오류가 발생하는지 확인

**테스트 단계**:
1. "휴무일 일시적 변경" 버튼 클릭
2. 일시적 변경 모달에서:
   - 임시 휴무일을 원래 휴무일과 동일하게 선택
   - 변경 사유 입력
3. "신청하기" 버튼 클릭

**예상 결과**:
- ✅ 검증 오류 메시지 표시
- ✅ 변경 신청이 거부됨

**실제 결과**: 
- [ ] 통과
- [ ] 실패 (비고: _______________)

---

### TC-013: 일시적 휴무일 변경 승인/거부
**목적**: 관리자가 일시적 변경 요청을 승인/거부할 수 있는지 확인

**전제 조건**:
- 관리자 권한으로 로그인
- 사용자가 일시적 변경 요청을 제출함

**테스트 단계**:
1. 관리자 페이지에서 "대기 중인 변경 요청" 확인
2. 요청 목록에서 해당 요청 확인
3. "승인" 또는 "거부" 버튼 클릭
4. 거부 시 사유 입력

**예상 결과**:
- ✅ 승인 시: 해당 주의 캘린더에 변경된 휴무일이 표시됨
- ✅ 거부 시: 원래 휴무일이 유지됨
- ✅ 상태가 "승인됨" 또는 "거부됨"으로 변경됨

**실제 결과**: 
- [ ] 통과
- [ ] 실패 (비고: _______________)

---

## 시 probation 기간 테스트

### TC-014: Probation 기간 중 주4일 근무제 미적용
**목적**: 입사 후 3개월 이내 사용자는 주4일 근무제가 적용되지 않는지 확인

**전제 조건**:
- 사용자의 `hire_date`가 3개월 이내

**테스트 단계**:
1. 사용자 데이터에서 `hire_date`를 최근 날짜로 설정
   ```sql
   UPDATE users
   SET hire_date = DATE_SUB(CURDATE(), INTERVAL 2 MONTH)
   WHERE email = 'sj2@simg.kr';
   ```
2. 페이지 새로고침
3. "Probation 기간" 알림 확인
4. 휴무일 표시 확인

**예상 결과**:
- ✅ "Probation 기간 중입니다" 알림 표시됨
- ✅ 휴무일이 표시되지 않거나, 모든 평일이 "근무일"로 표시됨
- ✅ 반차 신청 및 일시적 변경 버튼이 비활성화됨

**실제 결과**: 
- [ ] 통과
- [ ] 실패 (비고: _______________)

---

### TC-015: Probation 기간 종료 후 주4일 근무제 적용
**목적**: 입사 후 3개월 경과 시 주4일 근무제가 정상 적용되는지 확인

**전제 조건**:
- 사용자의 `hire_date`가 3개월 이상 전

**테스트 단계**:
1. 사용자 데이터에서 `hire_date`를 3개월 이상 전으로 설정
   ```sql
   UPDATE users
   SET hire_date = DATE_SUB(CURDATE(), INTERVAL 4 MONTH)
   WHERE email = 'sj2@simg.kr';
   ```
2. 페이지 새로고침
3. 휴무일 표시 확인

**예상 결과**:
- ✅ "Probation 기간" 알림이 표시되지 않음
- ✅ 휴무일이 정상적으로 표시됨
- ✅ 반차 신청 및 일시적 변경 버튼이 활성화됨

**실제 결과**: 
- [ ] 통과
- [ ] 실패 (비고: _______________)

---

## 타임존 및 날짜 계산 테스트

### TC-016: 월 경계 날짜 계산 정확성
**목적**: 월의 첫날과 마지막 날의 휴무일 계산이 정확한지 확인

**테스트 단계**:
1. 각 월의 1일과 마지막 날 확인
2. 해당 날짜의 휴무일 계산 확인
3. 주 시작일(월요일) 계산 확인

**예상 결과**:
- ✅ 월의 첫날과 마지막 날의 휴무일이 정확히 계산됨
- ✅ 주 시작일이 올바르게 계산됨 (항상 월요일)

**실제 결과**: 
- [ ] 통과
- [ ] 실패 (비고: _______________)

---

### TC-017: 서버와 클라이언트 날짜 일치 확인
**목적**: 서버에서 계산한 `daily_schedule`과 클라이언트 표시가 일치하는지 확인

**테스트 단계**:
1. 브라우저 개발자 도구 Network 탭 열기
2. `/api/staff/work-schedules/my-schedule/2025/12` API 호출 확인
3. 응답의 `daily_schedule` 데이터 확인
4. 캘린더 표시와 비교

**예상 결과**:
- ✅ 서버 응답의 `daily_schedule` 데이터가 정확함
- ✅ 캘린더 표시가 서버 데이터와 일치함
- ✅ 타임존 문제로 인한 날짜 불일치가 없음

**실제 결과**: 
- [ ] 통과
- [ ] 실패 (비고: _______________)

---

### TC-018: 다양한 월/년도 테스트
**목적**: 다양한 월과 년도에서 정확한 계산이 이루어지는지 확인

**테스트 단계**:
1. 2025년 1월~12월 각각 확인
2. 2024년 12월 확인 (이전 년도)
3. 2026년 1월 확인 (다음 년도)
4. 각 월의 휴무일 패턴 확인

**예상 결과**:
- ✅ 모든 월에서 정확한 휴무일 계산
- ✅ 년도 경계에서도 정확한 계산
- ✅ 4주 주기가 정확히 유지됨

**실제 결과**: 
- [ ] 통과
- [ ] 실패 (비고: _______________)

---

## 에러 케이스 테스트

### TC-019: work_days 데이터 없음
**목적**: `work_days` 데이터가 없는 경우 적절한 처리 확인

**전제 조건**:
- 사용자의 `work_days`가 NULL

**테스트 단계**:
1. 사용자 데이터에서 `work_days` 제거
   ```sql
   UPDATE users
   SET work_days = NULL
   WHERE email = 'sj2@simg.kr';
   ```
2. 페이지 새로고침
3. 에러 메시지 또는 기본 동작 확인

**예상 결과**:
- ✅ 적절한 에러 메시지 표시 또는 기본 근무일 표시
- ✅ 시스템이 크래시하지 않음

**실제 결과**: 
- [ ] 통과
- [ ] 실패 (비고: _______________)

---

### TC-020: 잘못된 cycle_start_date 형식
**목적**: 잘못된 날짜 형식의 `cycle_start_date` 처리 확인

**테스트 단계**:
1. 잘못된 형식의 `cycle_start_date` 설정
   ```sql
   UPDATE users
   SET work_days = JSON_SET(work_days, '$.cycle_start_date', 'invalid-date')
   WHERE email = 'sj2@simg.kr';
   ```
2. 페이지 새로고침
3. 에러 처리 확인

**예상 결과**:
- ✅ 적절한 에러 메시지 표시
- ✅ 시스템이 크래시하지 않음

**실제 결과**: 
- [ ] 통과
- [ ] 실패 (비고: _______________)

---

### TC-021: API 오류 처리
**목적**: API 호출 실패 시 적절한 에러 처리 확인

**테스트 단계**:
1. 서버를 일시적으로 중지
2. 페이지 접속 시도
3. 에러 메시지 확인

**예상 결과**:
- ✅ 사용자 친화적인 에러 메시지 표시
- ✅ 재시도 옵션 제공 (선택사항)

**실제 결과**: 
- [ ] 통과
- [ ] 실패 (비고: _______________)

---

## 통합 테스트

### TC-022: 전체 워크플로우 테스트
**목적**: 사용자가 처음부터 끝까지 전체 프로세스를 사용하는 시나리오

**테스트 단계**:
1. 사용자 로그인
2. 초기 휴무일 선택 (필요시)
3. 월별 스케줄 확인
4. 반차 신청
5. 일시적 휴무일 변경 신청
6. 관리자 승인/거부
7. 최종 스케줄 확인

**예상 결과**:
- ✅ 모든 단계가 정상적으로 작동
- ✅ 데이터 일관성 유지
- ✅ 사용자 경험이 원활함

**실제 결과**: 
- [ ] 통과
- [ ] 실패 (비고: _______________)

---

## 테스트 체크리스트

### 필수 테스트 항목
- [ ] TC-001: 기본 휴무일 표시 확인
- [ ] TC-002: 4주 주기 순환 확인
- [ ] TC-004: 공휴일 표시 확인
- [ ] TC-005: 공휴일 포함 주의 휴무일 취소
- [ ] TC-007: 같은 주 내 반차 신청 (성공)
- [ ] TC-008: 다른 주 반차 신청 (실패)
- [ ] TC-011: 일시적 휴무일 변경 신청 (성공)
- [ ] TC-014: Probation 기간 중 주4일 근무제 미적용
- [ ] TC-017: 서버와 클라이언트 날짜 일치 확인

### 권장 테스트 항목
- [ ] TC-003: 주차 정보 표시 확인
- [ ] TC-006: 공휴일이 없는 주의 정상 휴무일
- [ ] TC-009: 휴무일에 반차 신청 (실패)
- [ ] TC-010: 공휴일에 반차 신청 (실패)
- [ ] TC-012: 일시적 휴무일 변경 검증
- [ ] TC-013: 일시적 휴무일 변경 승인/거부
- [ ] TC-015: Probation 기간 종료 후 주4일 근무제 적용
- [ ] TC-016: 월 경계 날짜 계산 정확성
- [ ] TC-018: 다양한 월/년도 테스트

### 선택 테스트 항목
- [ ] TC-019: work_days 데이터 없음
- [ ] TC-020: 잘못된 cycle_start_date 형식
- [ ] TC-021: API 오류 처리
- [ ] TC-022: 전체 워크플로우 테스트

---

## 테스트 결과 요약

### 테스트 일자: _______________
### 테스트 담당자: _______________

### 통과율
- 총 테스트 케이스: ___ 개
- 통과: ___ 개
- 실패: ___ 개
- 통과율: ___ %

### 주요 이슈
1. 
2. 
3. 

### 개선 사항
1. 
2. 
3. 

---

## 부록: 테스트 데이터 준비 SQL

```sql
-- 1. 테스트 사용자 초기화
UPDATE users
SET work_days = JSON_OBJECT(
    'base_off_day', 5,
    'cycle_start_date', '2025-01-06',
    'initial_selection_date', '2025-01-06'
),
hire_date = DATE_SUB(CURDATE(), INTERVAL 4 MONTH)  -- Probation 기간 종료
WHERE email = 'sj2@simg.kr';

-- 2. Probation 기간 테스트용 (2개월 전 입사)
UPDATE users
SET hire_date = DATE_SUB(CURDATE(), INTERVAL 2 MONTH)
WHERE email = 'sj2@simg.kr';

-- 3. 공휴일 데이터 확인
SELECT holiday_date, name, year
FROM holidays
WHERE year = 2025
ORDER BY holiday_date;

-- 4. 기존 반차 데이터 삭제 (테스트용)
DELETE FROM leaves
WHERE user_id = 'sj2@simg.kr' AND leave_type IN ('HALF_AM', 'HALF_PM');

-- 5. 기존 일시적 변경 데이터 삭제 (테스트용)
DELETE FROM schedule_changes
WHERE user_id = 'sj2@simg.kr';
```

---

**문서 버전**: 1.0  
**최종 수정일**: 2025-12-28  
**작성자**: AI Assistant

