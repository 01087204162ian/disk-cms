# 직원 승인 가이드

**작성일**: 2026-01-XX  
**목적**: 승인대기 상태인 직원을 승인하는 방법 안내

---

## 📋 승인 페이지 위치

**별도의 승인 페이지는 없습니다.**  
승인은 **직원 리스트 페이지**에서 모달을 통해 처리합니다.

---

## 🔍 승인 방법

### 방법 1: 승인대기 필터 사용 (권장)

1. **직원 리스트 페이지 접근**
   - URL: `https://disk-cms.simg.kr/pages/staff/employees.html`
   - 또는 사이드바 → 직원전용 → 직원리스트

2. **상태 필터 설정**
   - 상태 필터에서 **"승인대기"** 선택
   - 승인대기 상태인 직원만 목록에 표시됩니다

3. **직원 상세보기 모달 열기**
   - 목록에서 승인대기 직원의 **번호 버튼**(첫 번째 컬럼) 클릭
   - 또는 모바일 카드에서 번호 버튼 클릭

4. **승인 버튼 클릭**
   - 모달 하단에 **"승인"** 버튼(초록색)이 표시됩니다
   - 승인 버튼 클릭
   - 확인 메시지에서 "확인" 클릭

5. **완료**
   - 승인 완료 메시지 표시
   - 목록이 자동으로 새로고침됩니다

### 방법 2: 전체 목록에서 찾기

1. **직원 리스트 페이지 접근**
   - 상태 필터는 "전체" 또는 "활성"으로 두고
   - 검색창에 승인대기 직원의 이름/이메일 입력

2. **직원 상세보기 모달 열기**
   - 목록에서 해당 직원의 번호 버튼 클릭

3. **상태 확인 및 승인**
   - 모달에서 상태가 "승인대기"인지 확인
   - 승인 버튼 클릭

---

## 📊 현재 상태 확인

직원 리스트 페이지 상단에 통계 정보가 표시됩니다:

```
직원 현황: 24명 | 승인대기 1명 | 활성 23명 | 비활성 0명
마지막 갱신: 2026. 1. 3. 오후 3:08:34
```

- **승인대기 1명**: 승인 대기 중인 직원이 1명 있다는 의미
- 상태 필터에서 "승인대기"를 선택하면 해당 직원을 쉽게 찾을 수 있습니다

---

## 🔐 권한 요구사항

승인 기능은 다음 권한을 가진 사용자만 사용할 수 있습니다:

- **SUPER_ADMIN** (최고관리자)
- **SYSTEM_ADMIN** (시스템관리자)
- **DEPT_MANAGER** (부서장) - 본인 부서 직원만

---

## 🔄 승인 프로세스 상세

### 1. 승인 API 호출

- **API 엔드포인트**: `POST /api/auth/approve-user`
- **요청 본문**:
  ```json
  {
    "email": "직원_이메일@example.com",
    "action": "approve"
  }
  ```

### 2. 데이터베이스 변경

- `users.is_active`: `0` (승인대기) → `1` (활성)
- `users.updated_at`: 현재 시간으로 업데이트
- `user_activity_logs`: 승인 기록 저장

### 3. 결과

- 직원 상태가 "승인대기" → "활성"으로 변경
- 직원이 시스템에 로그인할 수 있게 됨
- 활동 로그에 승인 기록이 저장됨

---

## ❌ 거절 방법

승인 대신 거절하려면:

1. 동일하게 직원 상세보기 모달 열기
2. **"거절"** 버튼(빨간색) 클릭
3. 확인 메시지에서 "확인" 클릭
4. **주의**: 거절 시 직원 계정이 **삭제**됩니다

---

## 🐛 문제 해결

### 승인 버튼이 보이지 않는 경우

1. **권한 확인**: 관리자 권한이 있는지 확인
2. **상태 확인**: 해당 직원이 실제로 승인대기 상태인지 확인
3. **페이지 새로고침**: 브라우저에서 페이지를 새로고침 (F5)

### 승인 후에도 목록에 표시되는 경우

1. **목록 새로고침**: "새로고침" 버튼 클릭
2. **필터 확인**: 상태 필터가 "승인대기"로 설정되어 있으면 "전체" 또는 "활성"으로 변경

### API 오류가 발생하는 경우

- 브라우저 개발자 도구(F12) → Console 탭에서 에러 메시지 확인
- 서버 로그 확인
- 네트워크 탭에서 API 응답 확인

---

## 📝 관련 파일

### 프론트엔드
- **페이지**: `public/pages/staff/employees.html`
- **JavaScript**: 
  - `public/js/staff/employee-list.js` - 목록 및 승인 함수
  - `public/js/staff/employee-modal.js` - 모달 및 버튼 표시

### 백엔드
- **API**: `routes/auth.js` - `/approve-user` 엔드포인트

---

## 📚 참고 자료

- [직원 관리 시스템 분석](./staff-시스템-분석.md)
- [Staff 시스템 학습 가이드](./STAFF_LEARNING_GUIDE.md)

---

**작성일**: 2026-01-XX  
**작성자**: AI Assistant  
**버전**: 1.0

