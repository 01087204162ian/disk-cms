# ì£¼ 4ì¼ ê·¼ë¬´ì œ ìš´ì˜ ì›ì¹™ (ìƒì„¸ ì •ë¦¬)

**ì‘ì„±ì¼**: 2025-01-XX  
**ë²„ì „**: 2.0

---

## ğŸ“‹ ëª©ì°¨

1. [ê¸°ë³¸ ìš´ì˜ ì›ì¹™](#1-ê¸°ë³¸-ìš´ì˜-ì›ì¹™)
2. [íœ´ë¬´ì¼ ìˆœí™˜ ì›ì¹™](#2-íœ´ë¬´ì¼-ìˆœí™˜-ì›ì¹™)
3. [ì¼ì‹œì  íœ´ë¬´ì¼ ë³€ê²½](#3-ì¼ì‹œì -íœ´ë¬´ì¼-ë³€ê²½)
4. [ë°˜ì°¨ ì‚¬ìš© ì›ì¹™](#4-ë°˜ì°¨-ì‚¬ìš©-ì›ì¹™)
5. [ê³µíœ´ì¼ í¬í•¨ ì£¼ ìš´ì˜](#5-ê³µíœ´ì¼-í¬í•¨-ì£¼-ìš´ì˜)
6. [ìˆ˜ìŠµ ê¸°ê°„ ìš´ì˜](#6-ìˆ˜ìŠµ-ê¸°ê°„-ìš´ì˜)
7. [ë°ì´í„° êµ¬ì¡° ì„¤ê³„](#7-ë°ì´í„°-êµ¬ì¡°-ì„¤ê³„)

---

## 1. ê¸°ë³¸ ìš´ì˜ ì›ì¹™

- ë‹¹ì‚¬ëŠ” ì£¼ 4ì¼ ê·¼ë¬´ì œë¥¼ ìš´ì˜í•œë‹¤.
- ì£¼ 4ì¼ ê·¼ë¬´ì— ë”°ë¥¸ íœ´ë¬´ì¼ì€ ê°œì¸ë³„ë¡œ ì§€ì •í•œë‹¤.
- ë³¸ ì›ì¹™ì€ ì´ë¯¸ ì‹œí–‰ ì¤‘ì¸ ì œë„ì˜ ìš´ì˜ ê¸°ì¤€ì„ ì •ë¦¬í•œ ê²ƒì´ë‹¤.

---

## 2. íœ´ë¬´ì¼ ìˆœí™˜ ì›ì¹™

### 2.1 ìˆœí™˜ ë°©ì‹

- íœ´ë¬´ì¼ì€ **4ì£¼ ë‹¨ìœ„**ë¡œ ìš”ì¼ì„ ìˆœí™˜í•œë‹¤.
- ìˆœí™˜ ë°©í–¥: **ë°˜ëŒ€ ë°©í–¥** (ê¸ˆâ†’ëª©â†’ìˆ˜â†’í™”â†’ì›”â†’ê¸ˆ)
- 4ì£¼(28ì¼)ë§ˆë‹¤ í•œ ìš”ì¼ì”© ì—­ë°©í–¥ìœ¼ë¡œ ì´ë™í•œë‹¤.

### 2.2 ìˆœí™˜ ì˜ˆì‹œ

```
ì˜ˆì‹œ) ê¹€ì² ìˆ˜ê°€ ì´ˆê¸°ì— 'í™”ìš”ì¼ íœ´ë¬´'ë¥¼ ì„ íƒí–ˆë‹¤ë©´:

1-4ì£¼: í™”ìš”ì¼ íœ´ë¬´ (ì´ˆê¸° ì„ íƒ)
5-8ì£¼: ì›”ìš”ì¼ íœ´ë¬´ (ì—­ë°©í–¥ ì´ë™)
9-12ì£¼: ê¸ˆìš”ì¼ íœ´ë¬´ (ì—­ë°©í–¥ ì´ë™)
13-16ì£¼: ëª©ìš”ì¼ íœ´ë¬´ (ì—­ë°©í–¥ ì´ë™)
17-20ì£¼: ìˆ˜ìš”ì¼ íœ´ë¬´ (ì—­ë°©í–¥ ì´ë™)
21-24ì£¼: í™”ìš”ì¼ íœ´ë¬´ (ìˆœí™˜ ë³µê·€)
```

### 2.3 ìˆœí™˜ ê³„ì‚° ë¡œì§

```javascript
/**
 * 4ì£¼ ì£¼ê¸°ë¡œ ë°˜ëŒ€ ë°©í–¥ ìˆœí™˜í•˜ëŠ” íœ´ë¬´ì¼ ê³„ì‚°
 * @param {Date} cycleStartDate - 4ì£¼ ì£¼ê¸° ì‹œì‘ì¼ (ì´ˆê¸° ì„ íƒì¼ ë˜ëŠ” ë§ˆì§€ë§‰ ë³€ê²½ì¼)
 * @param {Date} targetDate - ê³„ì‚° ëŒ€ìƒ ë‚ ì§œ
 * @param {number} initialOffDay - ì´ˆê¸° íœ´ë¬´ì¼ (1=ì›”, 2=í™”, 3=ìˆ˜, 4=ëª©, 5=ê¸ˆ)
 * @returns {number} í•´ë‹¹ ë‚ ì§œì˜ íœ´ë¬´ì¼ (1-5)
 */
function calculateOffDayByWeekCycle(cycleStartDate, targetDate, initialOffDay) {
    // ê²½ê³¼ ì¼ìˆ˜ ê³„ì‚°
    const daysDiff = Math.floor((targetDate - cycleStartDate) / (1000 * 60 * 60 * 24));
    
    // 4ì£¼(28ì¼) ë‹¨ìœ„ë¡œ ì£¼ê¸° ê³„ì‚°
    const cycles = Math.floor(daysDiff / 28);
    
    // ë°˜ëŒ€ ë°©í–¥ ìˆœí™˜: 5(ê¸ˆ) â†’ 4(ëª©) â†’ 3(ìˆ˜) â†’ 2(í™”) â†’ 1(ì›”) â†’ 5(ê¸ˆ)
    // ì£¼ê¸°ê°€ 1 ì¦ê°€í•  ë•Œë§ˆë‹¤ 1 ê°ì†Œ, 0 ì´í•˜ê°€ ë˜ë©´ 5ë¡œ ìˆœí™˜
    let currentOffDay = initialOffDay - cycles;
    
    // 0 ì´í•˜ê°€ ë˜ë©´ 5ë¡œ ìˆœí™˜
    while (currentOffDay <= 0) {
        currentOffDay += 5;
    }
    
    // 5 ì´ˆê³¼ê°€ ë˜ë©´ 5ë¡œ ë‚˜ëˆˆ ë‚˜ë¨¸ì§€ë¡œ ì¡°ì •
    while (currentOffDay > 5) {
        currentOffDay -= 5;
    }
    
    return currentOffDay;
}
```

### 2.4 ê³ ì • íœ´ë¬´ ê¸ˆì§€

- íŠ¹ì • ìš”ì¼ì˜ ê³ ì • íœ´ë¬´ëŠ” í—ˆìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.
- ëª¨ë“  ì§ì›ì´ ê° ìš”ì¼ íœ´ë¬´ë¥¼ ìˆœí™˜í•˜ë©° ê²½í—˜í•´ì•¼ í•œë‹¤.

---

## 3. ì¼ì‹œì  íœ´ë¬´ì¼ ë³€ê²½

### 3.1 ë³€ê²½ ì›ì¹™

- ì›ë˜ íœ´ë¬´ì¼ê³¼ ë‹¤ë¥¸ ìš”ì¼ë¡œ **íŠ¹ì • ì£¼ë§Œ** ë³€ê²½ ê°€ëŠ¥í•˜ë‹¤.
- ë³€ê²½ í›„ ë‹¤ìŒ ì£¼ë¶€í„°ëŠ” ì›ë˜ ìˆœí™˜ íŒ¨í„´ìœ¼ë¡œ ë³µê·€í•œë‹¤.
- ë³€ê²½ì€ **ì—…ë¬´ ëŒ€ì²´ìë‚˜ íŒ€ì¥ì˜ ìŠ¹ì¸**ì´ ìˆì–´ì•¼ ê°€ëŠ¥í•˜ë‹¤.

### 3.2 ë³€ê²½ í”„ë¡œì„¸ìŠ¤

1. **ë³€ê²½ ìš”ì²­**
   - ì§ì›ì´ íŠ¹ì • ì£¼ì˜ íœ´ë¬´ì¼ ë³€ê²½ ìš”ì²­
   - ë³€ê²½ ì‚¬ìœ  ëª…ì‹œ
   - ì›ë˜ íœ´ë¬´ì¼ â†’ ë³€ê²½í•  íœ´ë¬´ì¼ ì„ íƒ

2. **ëŒ€ì²´ì í™•ì¸**
   - ë³€ê²½ ìš”ì²­í•œ ìš”ì¼ì— ë‹¤ë¥¸ ì§ì›ì´ ê·¼ë¬´í•˜ëŠ”ì§€ í™•ì¸
   - ì—…ë¬´ ê³µë°±ì´ ë°œìƒí•˜ì§€ ì•Šë„ë¡ ê²€ì¦

3. **ìŠ¹ì¸**
   - ì—…ë¬´ ëŒ€ì²´ì í™•ì¸ ë˜ëŠ” íŒ€ì¥ ìŠ¹ì¸
   - ìŠ¹ì¸ ì‹œ í•´ë‹¹ ì£¼ì—ë§Œ ì ìš©

4. **ì ìš©**
   - í•´ë‹¹ ì£¼ì—ë§Œ ë³€ê²½ëœ íœ´ë¬´ì¼ ì ìš©
   - ë‹¤ìŒ ì£¼ë¶€í„°ëŠ” ì›ë˜ ìˆœí™˜ íŒ¨í„´ìœ¼ë¡œ ë³µê·€

### 3.3 ì˜ˆì‹œ

```
ê¹€ì² ìˆ˜: ì›ë˜ í™”ìš”ì¼ íœ´ë¬´ (1-4ì£¼)
ìš”ì²­: 2ì£¼ì°¨ë§Œ ê¸ˆìš”ì¼ë¡œ ë³€ê²½
ìŠ¹ì¸: ì—…ë¬´ ëŒ€ì²´ì(ì´ì˜í¬) í™•ì¸ ì™„ë£Œ
ê²°ê³¼:
  - 1ì£¼ì°¨: í™”ìš”ì¼ íœ´ë¬´ (ì›ë˜ëŒ€ë¡œ)
  - 2ì£¼ì°¨: ê¸ˆìš”ì¼ íœ´ë¬´ (ì„ì‹œ ë³€ê²½)
  - 3ì£¼ì°¨: í™”ìš”ì¼ íœ´ë¬´ (ì›ë˜ëŒ€ë¡œ ë³µê·€)
  - 4ì£¼ì°¨: í™”ìš”ì¼ íœ´ë¬´ (ì›ë˜ëŒ€ë¡œ)
  - 5ì£¼ì°¨: ì›”ìš”ì¼ íœ´ë¬´ (ìˆœí™˜ëŒ€ë¡œ)
```

### 3.4 ë°ì´í„° êµ¬ì¡°

```json
{
  "week_start_date": "2025-01-06",  // í•´ë‹¹ ì£¼ ì‹œì‘ì¼ (ì›”ìš”ì¼)
  "original_off_day": 2,             // ì›ë˜ íœ´ë¬´ì¼ (í™”ìš”ì¼)
  "temporary_off_day": 5,            // ì„ì‹œ íœ´ë¬´ì¼ (ê¸ˆìš”ì¼)
  "changed_by": "kim@example.com",   // ë³€ê²½ ìš”ì²­ì
  "approved_by": "manager@example.com", // ìŠ¹ì¸ì
  "approval_date": "2025-01-05",     // ìŠ¹ì¸ì¼
  "reason": "ê°œì¸ ì‚¬ì •ìœ¼ë¡œ ì¸í•œ ì¼ì‹œì  ë³€ê²½",
  "substitute_employee": "lee@example.com" // ì—…ë¬´ ëŒ€ì²´ì (ì„ íƒì‚¬í•­)
}
```

---

## 4. ë°˜ì°¨ ì‚¬ìš© ì›ì¹™

### 4.1 ê¸°ë³¸ ì›ì¹™

- íœ´ë¬´ì¼ì€ 2ê°œì˜ ë°˜ì°¨(AM / PM)ë¡œ ë¶„í• í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
- ë°˜ì°¨ëŠ” **ê°™ì€ ì£¼(ì›”~ì¼ ê¸°ì¤€) ë‚´ì—ì„œë§Œ** ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤.
- ì£¼ë¥¼ ì´ˆê³¼í•˜ì—¬ ë°˜ì°¨ë¥¼ ì´ì›” ì‚¬ìš©í•˜ëŠ” ê²ƒì€ í—ˆìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.

### 4.2 ë°˜ì°¨ ì¢…ë¥˜

- **ì˜¤ì „ ë°˜ì°¨ (HALF_AM)**: ì˜¤í›„ 14ì‹œ ì¶œê·¼ (ì˜¤í›„ 4ì‹œê°„ ê·¼ë¬´)
- **ì˜¤í›„ ë°˜ì°¨ (HALF_PM)**: ì˜¤í›„ 14ì‹œ í‡´ê·¼ (ì˜¤ì „ 4ì‹œê°„ ê·¼ë¬´)

### 4.3 ë°˜ì°¨ ì‚¬ìš© ì˜ˆì‹œ

```
ê¹€ì² ìˆ˜: í™”ìš”ì¼ íœ´ë¬´ (1ì£¼ì°¨)
ìš”ì²­: ëª©ìš”ì¼ ì˜¤í›„ ë°˜ì°¨ ì‚¬ìš©
ì²˜ë¦¬:
  - ëª©ìš”ì¼: ì˜¤ì „ 4ì‹œê°„ ê·¼ë¬´ (14ì‹œ í‡´ê·¼)
  - í™”ìš”ì¼: ì˜¤í›„ 4ì‹œê°„ ê·¼ë¬´ (14ì‹œ ì¶œê·¼) - ì›ë˜ íœ´ë¬´ì¼ì„ ë°˜ìœ¼ë¡œ ë‚˜ëˆ”
  - ì´ ê·¼ë¬´ì‹œê°„: 32ì‹œê°„ ìœ ì§€
```

### 4.4 ë°˜ì°¨ ê²€ì¦

- ë°˜ì°¨ ì‚¬ìš© ì‹œ ê°™ì€ ì£¼ ë‚´ì—ì„œë§Œ ì²˜ë¦¬ë˜ëŠ”ì§€ ê²€ì¦
- ì£¼ ì´ˆê³¼ ë°˜ì°¨ ì´ì›” ì‹œë„ ì‹œ ì˜¤ë¥˜ ì²˜ë¦¬

---

## 5. ê³µíœ´ì¼ í¬í•¨ ì£¼ ìš´ì˜

### 5.1 ê¸°ë³¸ ì›ì¹™

- ë²•ì • ê³µíœ´ì¼ì€ ìœ ê¸‰íœ´ì¼ë¡œ ë³´ì¥í•œë‹¤.
- ì£¼ì¤‘ì— ê³µíœ´ì¼ì´ í¬í•¨ëœ ì£¼ì—ëŠ” ì£¼ 4ì¼ ê·¼ë¬´ì— ë”°ë¥¸ ì¶”ê°€ íœ´ë¬´ì¼ì„ ì ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.
- í•´ë‹¹ ì£¼ì—ëŠ” íœ´ë¬´ì¼ ë¶„í• (ë°˜ì°¨)ì„ ì ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.

### 5.2 ê³µíœ´ì¼ ì²˜ë¦¬ ì˜ˆì‹œ

```
ì˜ˆì‹œ) 1ì£¼ì°¨ì— í™”ìš”ì¼ì´ ê³µíœ´ì¼ì¸ ê²½ìš°:

ê¹€ì² ìˆ˜: ì›ë˜ í™”ìš”ì¼ íœ´ë¬´ (1ì£¼ì°¨)
ê²°ê³¼:
  - ì›”ìš”ì¼: ê·¼ë¬´
  - í™”ìš”ì¼: ê³µíœ´ì¼ (ìœ ê¸‰íœ´ì¼)
  - ìˆ˜ìš”ì¼: ê·¼ë¬´
  - ëª©ìš”ì¼: ê·¼ë¬´
  - ê¸ˆìš”ì¼: ê·¼ë¬´
  - í•´ë‹¹ ì£¼ ê·¼ë¬´ì¼: 4ì¼ (ê³µíœ´ì¼ í¬í•¨)
  - ì¶”ê°€ íœ´ë¬´ì¼ ì—†ìŒ
  - ë°˜ì°¨ ë¶„í•  ë¶ˆê°€
```

### 5.3 êµ¬í˜„ ë¡œì§

```javascript
/**
 * ê³µíœ´ì¼ í¬í•¨ ì£¼ì¸ì§€ í™•ì¸
 * @param {Date} weekStartDate - ì£¼ ì‹œì‘ì¼ (ì›”ìš”ì¼)
 * @returns {boolean} ê³µíœ´ì¼ í¬í•¨ ì—¬ë¶€
 */
async function hasHolidayInWeek(weekStartDate) {
    const weekEndDate = new Date(weekStartDate);
    weekEndDate.setDate(weekEndDate.getDate() + 4); // ê¸ˆìš”ì¼ê¹Œì§€
    
    // holidays í…Œì´ë¸”ì—ì„œ í•´ë‹¹ ì£¼ì˜ ê³µíœ´ì¼ í™•ì¸
    const [holidays] = await pool.execute(`
        SELECT COUNT(*) as count 
        FROM holidays 
        WHERE holiday_date BETWEEN ? AND ?
    `, [weekStartDate, weekEndDate]);
    
    return holidays[0].count > 0;
}
```

---

## 6. ìˆ˜ìŠµ ê¸°ê°„ ìš´ì˜

### 6.1 ê¸°ë³¸ ì›ì¹™

- ì…ì‚¬ í›„ 3ê°œì›” ë¯¸ë§Œì˜ ìˆ˜ìŠµ ê¸°ê°„ì—ëŠ” ì£¼ 4ì¼ ê·¼ë¬´ë¥¼ ì ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.
- ìˆ˜ìŠµ ê¸°ê°„ ì¤‘ì—ëŠ” ì›”ì°¨(ì—°ì°¨)ë§Œ ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤.
- ìˆ˜ìŠµ ê¸°ê°„ ì¤‘ì—ëŠ” íœ´ë¬´ì¼ ë° ë°˜ì°¨ ì‚¬ìš©ì„ í—ˆìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.

### 6.2 ìˆ˜ìŠµ ê¸°ê°„ ê³„ì‚°

```javascript
/**
 * ìˆ˜ìŠµ ê¸°ê°„ì¸ì§€ í™•ì¸
 * @param {Date} hireDate - ì…ì‚¬ì¼
 * @param {Date} targetDate - í™•ì¸ ëŒ€ìƒ ë‚ ì§œ
 * @returns {boolean} ìˆ˜ìŠµ ê¸°ê°„ ì—¬ë¶€
 */
function isProbationPeriod(hireDate, targetDate) {
    const monthsDiff = (targetDate.getFullYear() - hireDate.getFullYear()) * 12 + 
                       (targetDate.getMonth() - hireDate.getMonth());
    
    return monthsDiff < 3;
}
```

### 6.3 ìˆ˜ìŠµ ê¸°ê°„ ì œí•œ

- 4ì¼ì œ ìŠ¤ì¼€ì¤„ ì¡°íšŒ ë¶ˆê°€
- ë°˜ì°¨ ì‹ ì²­ ë¶ˆê°€
- íœ´ë¬´ì¼ ë³€ê²½ ë¶ˆê°€
- ì›”ì°¨(ì—°ì°¨)ë§Œ ì‚¬ìš© ê°€ëŠ¥

---

## 7. ë°ì´í„° êµ¬ì¡° ì„¤ê³„

> **ì°¸ê³ **: ì‹¤ì œ DB ìŠ¤í‚¤ë§ˆ ë¶„ì„ì€ [ì£¼4ì¼ DB ìŠ¤í‚¤ë§ˆ ë¶„ì„](./ì£¼4ì¼-DB-ìŠ¤í‚¤ë§ˆ-ë¶„ì„.md) ë¬¸ì„œë¥¼ ì°¸ì¡°í•˜ì„¸ìš”.

### 7.1 users í…Œì´ë¸”

**í˜„ì¬ ìƒíƒœ**: `hire_date` í•„ë“œëŠ” ì´ë¯¸ ì¡´ì¬í•¨ âœ…

```sql
-- work_days JSON í•„ë“œ ì¶”ê°€ í•„ìš”
ALTER TABLE users 
ADD COLUMN work_days json DEFAULT NULL 
COMMENT 'ê°œì¸ ì‹œí”„íŠ¸ ì •ë³´: {"base_off_day": 2, "cycle_start_date": "2025-01-06", "initial_selection_date": "2025-01-06"}' 
AFTER work_schedule;

-- work_days JSON êµ¬ì¡°
{
    "base_off_day": 2,                    // ì´ˆê¸° íœ´ë¬´ì¼ (1=ì›”, 2=í™”, 3=ìˆ˜, 4=ëª©, 5=ê¸ˆ)
    "cycle_start_date": "2025-01-06",     // 4ì£¼ ì£¼ê¸° ì‹œì‘ì¼
    "initial_selection_date": "2025-01-06" // ìµœì´ˆ ì„ íƒì¼
}
```

### 7.2 work_schedules í…Œì´ë¸”

**í˜„ì¬ ìƒíƒœ**: `work_days` JSON í•„ë“œëŠ” ì´ë¯¸ ì¡´ì¬í•¨ âœ…, `temporary_change` í•„ë“œ ì¶”ê°€ í•„ìš”

```sql
-- ì¼ì‹œì  ë³€ê²½ ê¸°ë¡ í•„ë“œ ì¶”ê°€
ALTER TABLE work_schedules 
ADD COLUMN temporary_change json DEFAULT NULL 
COMMENT 'íŠ¹ì • ì£¼ì˜ ì¼ì‹œì  íœ´ë¬´ì¼ ë³€ê²½ ì •ë³´' 
AFTER work_days;

-- work_days JSON êµ¬ì¡°
{
    "base_off_day": 2,                    // ì´ë²ˆ ì£¼ê¸° ê¸°ë³¸ íœ´ë¬´ì¼
    "days": {
        "1": "full",     // ì›”: ì¢…ì¼(8h)
        "2": "off",      // í™”: íœ´ë¬´ (ê¸°ë³¸)
        "3": "full",     // ìˆ˜: ì¢…ì¼(8h)
        "4": "full",     // ëª©: ì¢…ì¼(8h)
        "5": "full"      // ê¸ˆ: ì¢…ì¼(8h)
    },
    "total_hours": 32,
    "work_days_count": 4
}

-- temporary_change JSON êµ¬ì¡° (í•´ë‹¹ ì£¼ì— ì¼ì‹œì  ë³€ê²½ì´ ìˆëŠ” ê²½ìš°)
{
    "week_start_date": "2025-01-06",
    "original_off_day": 2,
    "temporary_off_day": 5,
    "changed_by": "kim@example.com",
    "approved_by": "manager@example.com",
    "approval_date": "2025-01-05",
    "reason": "ê°œì¸ ì‚¬ì •",
    "substitute_employee": "lee@example.com"
}
```

### 7.3 leaves í…Œì´ë¸” (ê¸°ì¡´ êµ¬ì¡° ìœ ì§€)

```sql
-- leave_type: HALF_AM, HALF_PM ì‚¬ìš©
-- ë°˜ì°¨ëŠ” ê°™ì€ ì£¼ ë‚´ì—ì„œë§Œ ì‚¬ìš© ê°€ëŠ¥í•˜ë¯€ë¡œ ë³„ë„ ê²€ì¦ ë¡œì§ í•„ìš”
```

### 7.4 schedule_changes í…Œì´ë¸” (ì‹ ê·œ - ì¼ì‹œì  ë³€ê²½ ì´ë ¥)

```sql
CREATE TABLE schedule_changes (
    id INT AUTO_INCREMENT PRIMARY KEY,
    schedule_id INT NOT NULL,
    user_id VARCHAR(100) NOT NULL,
    week_start_date DATE NOT NULL,
    original_off_day INT NOT NULL COMMENT '1=ì›”, 2=í™”, 3=ìˆ˜, 4=ëª©, 5=ê¸ˆ',
    temporary_off_day INT NOT NULL,
    reason TEXT,
    status ENUM('PENDING', 'APPROVED', 'REJECTED') DEFAULT 'PENDING',
    requested_by VARCHAR(100) NOT NULL,
    approved_by VARCHAR(100),
    approval_date DATETIME,
    substitute_employee VARCHAR(100),
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    FOREIGN KEY (schedule_id) REFERENCES work_schedules(id),
    FOREIGN KEY (user_id) REFERENCES users(email),
    FOREIGN KEY (requested_by) REFERENCES users(email),
    FOREIGN KEY (approved_by) REFERENCES users(email),
    FOREIGN KEY (substitute_employee) REFERENCES users(email),
    
    INDEX idx_user_week (user_id, week_start_date),
    INDEX idx_status (status)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='íœ´ë¬´ì¼ ì¼ì‹œì  ë³€ê²½ ì´ë ¥';
```

---

## 8. API ì—”ë“œí¬ì¸íŠ¸ ì„¤ê³„

### 8.1 ìˆœí™˜ ê³„ì‚°

```
GET /api/staff/work-schedules/calculate-off-day
Query Parameters:
  - date: ê³„ì‚° ëŒ€ìƒ ë‚ ì§œ (YYYY-MM-DD)
Response:
{
  "success": true,
  "data": {
    "target_date": "2025-01-15",
    "off_day": 2,
    "off_day_name": "í™”ìš”ì¼",
    "cycle_week": 1  // í˜„ì¬ ì£¼ê¸°ê°€ ì‹œì‘ëœ ì§€ ëª‡ ì£¼ì§¸ì¸ì§€ (1-4)
  }
}
```

### 8.2 ì¼ì‹œì  ë³€ê²½ ìš”ì²­

```
POST /api/staff/work-schedules/temporary-change
Body:
{
  "week_start_date": "2025-01-06",
  "temporary_off_day": 5,
  "reason": "ê°œì¸ ì‚¬ì •ìœ¼ë¡œ ì¸í•œ ì¼ì‹œì  ë³€ê²½",
  "substitute_employee": "lee@example.com"  // ì„ íƒì‚¬í•­
}
```

### 8.3 ìŠ¹ì¸ ëŒ€ê¸° ëª©ë¡ (íŒ€ì¥ìš©)

```
GET /api/staff/work-schedules/pending-changes
Response:
{
  "success": true,
  "data": [
    {
      "id": 1,
      "user_name": "ê¹€ì² ìˆ˜",
      "week_start_date": "2025-01-06",
      "original_off_day": 2,
      "temporary_off_day": 5,
      "reason": "ê°œì¸ ì‚¬ì •",
      "requested_at": "2025-01-05T10:00:00Z"
    }
  ]
}
```

### 8.4 ìŠ¹ì¸/ê±°ë¶€

```
POST /api/staff/work-schedules/approve-change/:changeId
Body:
{
  "action": "approve",  // or "reject"
  "notes": "ìŠ¹ì¸ ì™„ë£Œ"
}
```

---

**ë¬¸ì„œ ë²„ì „**: 2.0  
**ìµœì¢… ì—…ë°ì´íŠ¸**: 2025-01-XX

