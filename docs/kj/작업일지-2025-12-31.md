# KJ ëŒ€ë¦¬ìš´ì „ ì‹œìŠ¤í…œ ì‘ì—… ì¼ì§€

**ì‘ì„±ì¼**: 2025-12-31  
**ì‘ì—…ì**: AI Assistant

---

## ğŸ“‹ ì‘ì—… ê°œìš”

ë³´í—˜ë£Œ ê³„ì‚°ì‹ ë³€ê²½ ë° UI ê°œì„  ì‘ì—…ì„ ìˆ˜í–‰í–ˆìŠµë‹ˆë‹¤. ì¦ê¶Œë²ˆí˜¸ í•„í„° UI ê°œì„ , ë©”ë‰´ ë ˆì´ë¸” ë³€ê²½, ë³´í—˜ë£Œ ê³„ì‚° ë¡œì§ ê°œì„  ì‘ì—…ì„ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤.

---

## âœ… ì™„ë£Œëœ ì‘ì—…

### 1. í•„í„° ë ˆì´ë¸” ì‚­ì œ ë° ì„ íƒë°•ìŠ¤ ê¸°ë³¸ê°’ ë³€ê²½

#### 1.1 kj-driver-code-by-policy.html
- í•„í„° ë ˆì´ë¸” "ì¦ê¶Œë²ˆí˜¸" ì‚­ì œ
- ì„ íƒë°•ìŠ¤ ê¸°ë³¸ê°’ ë³€ê²½: `=ì„ íƒ=` â†’ `ì¦ê¶Œë²ˆí˜¸`
- ê´€ë ¨ ì£¼ì„ ì—…ë°ì´íŠ¸

#### 1.2 kj-driver-policy-search.html (ê°±ì‹  ë©”ë‰´)
- í•„í„° ë ˆì´ë¸” "ì¦ê¶Œë²ˆí˜¸" ì‚­ì œ
- ì„ íƒë°•ìŠ¤ ê¸°ë³¸ê°’ ë³€ê²½: `=ì„ íƒ=` â†’ `ì¦ê¶Œë²ˆí˜¸`
- ê´€ë ¨ ì£¼ì„ ì—…ë°ì´íŠ¸

#### ìˆ˜ì • íŒŒì¼
- `disk-cms/public/js/insurance/kj-driver-code-by-policy.js`
- `disk-cms/public/pages/insurance/kj-driver-policy-search.html`
- `disk-cms/public/js/insurance/kj-driver-policy-search.js`

---

### 2. ì¢Œì¸¡ ë©”ë‰´ ë ˆì´ë¸” ë³€ê²½

#### ì‘ì—… ë‚´ìš©
- "ì¦ê¶Œë²ˆí˜¸ì°¾ê¸°" â†’ "ê°±ì‹ "ìœ¼ë¡œ ë³€ê²½

#### ìˆ˜ì • íŒŒì¼
- `disk-cms/public/components/sj-sidebar.html` - ì‚¬ì´ë“œë°” ë©”ë‰´ ë ˆì´ë¸”
- `disk-cms/public/js/template-loader3.js` - í˜ì´ì§€ íƒ€ì´í‹€
- `disk-cms/public/pages/insurance/kj-driver-policy-search.html` - ë¸Œë¼ìš°ì € íƒ­ ì œëª©

---

### 3. ë³´í—˜ë£Œ ê³„ì‚°ì‹ ë³€ê²½

#### 3.1 í”„ë¡ íŠ¸ì—”ë“œ ê³„ì‚°ì‹ ë³€ê²½

**ë³€ê²½ ì „**: `ë…„ê³„ = ë…„ê¸°ë³¸ Ã— 10`  
**ë³€ê²½ í›„**: `ë…„ê³„ = (ë…„ê¸°ë³¸ + ë…„íŠ¹ì•½) Ã— 10`

#### ìˆ˜ì • ë‚´ìš©
- `calculateYearTotal()` í•¨ìˆ˜ ìˆ˜ì • (861-877ë²ˆ ë¼ì¸)
  - ë…„ê¸°ë³¸ê³¼ ë…„íŠ¹ì•½ì„ í•©ì‚°í•œ í›„ Ã— 10ìœ¼ë¡œ ê³„ì‚°
- ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€ (824, 826ë²ˆ ë¼ì¸)
  - ë…„ê¸°ë³¸ ì…ë ¥ ì‹œ: `calculateYearTotal()` í˜¸ì¶œ
  - ë…„íŠ¹ì•½ ì…ë ¥ ì‹œ: `calculateYearTotal()` í˜¸ì¶œ
- ëª¨ë‹¬ ìƒˆë¡œê³ ì¹¨ ì‹œì—ë„ ë™ì¼í•˜ê²Œ ì„¤ì • (982, 984ë²ˆ ë¼ì¸)

#### ìˆ˜ì • íŒŒì¼
- `disk-cms/public/js/insurance/kj-driver-code-by-policy.js`

---

### 4. ë°±ì—”ë“œ ë³´í—˜ë£Œ ê³„ì‚° ë¡œì§ ìˆ˜ì •

#### 4.1 kj-insurance-premium-data.php ê¸°ë³¸ê°’ ê³„ì‚° ë³€ê²½

**ë³€ê²½ ì „**:
```php
$payment10PremiumTotal = ($payment10Premium1 ?? 0) + ($payment10Premium2 ?? 0);
```

**ë³€ê²½ í›„**:
```php
$payment10PremiumTotal = (($payment10Premium1 ?? 0) + ($payment10Premium2 ?? 0)) * 10;
```

#### 4.2 kj_premium_data ì¬ìƒì„± ë¡œì§ ê°œì„ 

**ë³€ê²½ ë‚´ìš©**:
- `monthly_premium1` ê³„ì‚° ì¶”ê°€: `ROUND(payment10_premium1 Ã— 10 / 12)`
- `monthly_premium2` ê³„ì‚° ì¶”ê°€: `ROUND(payment10_premium2 Ã— 10 / 12)`
- `monthly_premium_total` ê³„ì‚° ìˆ˜ì •: `ROUND((payment10_premium1 + payment10_premium2) Ã— 10 / 12)`

**ë³€ê²½ ì „**:
```sql
INSERT INTO kj_premium_data (
    cNum, rowNum, start_month, end_month,
    monthly_premium_total,
    payment10_premium1, payment10_premium2, payment10_premium_total,
    ...
)
SELECT
    ...
    ROUND((ip.payment10_premium1 + COALESCE(ip.payment10_premium2, 0)) * 10 / 12) AS monthly_premium_total,
    ...
```

**ë³€ê²½ í›„**:
```sql
INSERT INTO kj_premium_data (
    cNum, rowNum, start_month, end_month,
    monthly_premium1,
    monthly_premium2,
    monthly_premium_total,
    payment10_premium1, payment10_premium2, payment10_premium_total,
    ...
)
SELECT
    ...
    ROUND(ip.payment10_premium1 * 10 / 12) AS monthly_premium1,
    ROUND(COALESCE(ip.payment10_premium2, 0) * 10 / 12) AS monthly_premium2,
    ROUND((ip.payment10_premium1 + COALESCE(ip.payment10_premium2, 0)) * 10 / 12) AS monthly_premium_total,
    ...
```

#### ìˆ˜ì • íŒŒì¼
- `pci0327/api/insurance/kj-insurance-premium-data.php`

---

### 5. ë³´í—˜ë£Œ ì…ë ¥ ë°©ì‹ ì„¤ëª… ë¬¸ì„œ ì‘ì„±

#### ì‘ì—… ë‚´ìš©
- `kj_insurance_premium_data` ë³´í—˜ë£Œ ì…ë ¥ ë°©ì‹ì— ëŒ€í•œ ìƒì„¸ ì„¤ëª… ë¬¸ì„œ ì‘ì„±
- ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡°, í”„ë¡ íŠ¸ì—”ë“œ ì…ë ¥ ëª¨ë‹¬, ë°±ì—”ë“œ ì €ì¥ í”„ë¡œì„¸ìŠ¤ ì„¤ëª…
- ê³„ì‚°ì‹ ë³€ê²½ ì´ë ¥ ë° ê¶Œì¥ ì‚¬í•­ í¬í•¨

#### ì‘ì„± íŒŒì¼
- `disk-cms/docs/kj/ë³´í—˜ë£Œ-ì…ë ¥-ë°©ì‹-ì„¤ëª….md`

---

## ğŸ“Š ì‘ì—… í†µê³„

- **ìˆ˜ì •ëœ íŒŒì¼**: 7ê°œ
  - JavaScript íŒŒì¼: 2ê°œ
  - HTML íŒŒì¼: 1ê°œ
  - PHP íŒŒì¼: 1ê°œ
  - ì»´í¬ë„ŒíŠ¸ íŒŒì¼: 2ê°œ
  - í…œí”Œë¦¿ ë¡œë”: 1ê°œ
- **ì‘ì„±ëœ ë¬¸ì„œ**: 1ê°œ
- **ìˆ˜ì •ëœ í•¨ìˆ˜**: 2ê°œ
  - `calculateYearTotal()`: ê³„ì‚°ì‹ ë³€ê²½
  - `kj_premium_data` ì¬ìƒì„± SQL: í•„ë“œ ì¶”ê°€ ë° ê³„ì‚°ì‹ ë³€ê²½
- **ê°œì„ ëœ ê¸°ëŠ¥**: 3ê°œ
  - í•„í„° UI ê°œì„ 
  - ë©”ë‰´ ë ˆì´ë¸” ë³€ê²½
  - ë³´í—˜ë£Œ ê³„ì‚° ë¡œì§ ê°œì„ 

---

## ğŸ” ì£¼ìš” ê°œì„  ì‚¬í•­

### 1. UI/UX ê°œì„ 
- í•„í„° ë ˆì´ë¸” ì œê±°ë¡œ ê³µê°„ í™œìš©ë„ í–¥ìƒ
- ì„ íƒë°•ìŠ¤ ê¸°ë³¸ê°’ì„ "ì¦ê¶Œë²ˆí˜¸"ë¡œ ë³€ê²½í•˜ì—¬ ì§ê´€ì„± í–¥ìƒ
- ë©”ë‰´ ë ˆì´ë¸”ì„ "ê°±ì‹ "ìœ¼ë¡œ ë³€ê²½í•˜ì—¬ ê¸°ëŠ¥ ëª…í™•í™”

### 2. ë³´í—˜ë£Œ ê³„ì‚° ë¡œì§ ê°œì„ 
- í”„ë¡ íŠ¸ì—”ë“œì™€ ë°±ì—”ë“œ ê³„ì‚°ì‹ ì¼ì¹˜
- `(ë…„ê¸°ë³¸ + ë…„íŠ¹ì•½) Ã— 10 = ë…„ê³„` ê³µì‹ìœ¼ë¡œ ì •í™•ì„± í–¥ìƒ
- `kj_premium_data` ì¬ìƒì„± ì‹œ `monthly_premium1`, `monthly_premium2` í•„ë“œ ìë™ ê³„ì‚°

### 3. ë°ì´í„° ì¼ê´€ì„± í–¥ìƒ
- í”„ë¡ íŠ¸ì—”ë“œ ê³„ì‚° ê²°ê³¼ì™€ ë°±ì—”ë“œ ì €ì¥ ë°ì´í„° ì¼ì¹˜
- `kj_insurance_premium_data` â†’ `kj_premium_data` ìë™ ì¬ìƒì„± ì‹œ ëª¨ë“  í•„ë“œ ì •í™•íˆ ê³„ì‚°

---

## ğŸ“ ê¸°ìˆ  ì„¸ë¶€ì‚¬í•­

### ë³´í—˜ë£Œ ê³„ì‚° ê³µì‹

#### ë…„ê³„ ê³„ì‚°
```
ë…„ê³„ = (ë…„ê¸°ë³¸ + ë…„íŠ¹ì•½) Ã— 10
```

#### ì›”ë³´í—˜ë£Œ ê³„ì‚°
```
monthly_premium1 = ROUND(payment10_premium1 Ã— 10 / 12)
monthly_premium2 = ROUND(payment10_premium2 Ã— 10 / 12)
monthly_premium_total = ROUND((payment10_premium1 + payment10_premium2) Ã— 10 / 12)
```

### ë°ì´í„° íë¦„

```
[ì‚¬ìš©ì ì…ë ¥]
ë…„ê¸°ë³¸ + ë…„íŠ¹ì•½ ì…ë ¥
  â†“
[í”„ë¡ íŠ¸ì—”ë“œ ê³„ì‚°]
ë…„ê³„ = (ë…„ê¸°ë³¸ + ë…„íŠ¹ì•½) Ã— 10 (ìë™ ê³„ì‚°)
  â†“
[ë°±ì—”ë“œ ì €ì¥]
kj_insurance_premium_data í…Œì´ë¸”ì— ì €ì¥
- payment10_premium_total = (payment10_premium1 + payment10_premium2) Ã— 10
  â†“
[ìë™ ì¬ìƒì„±]
kj_premium_data í…Œì´ë¸” ì¬ìƒì„±
- monthly_premium1 = ROUND(payment10_premium1 Ã— 10 / 12)
- monthly_premium2 = ROUND(payment10_premium2 Ã— 10 / 12)
- monthly_premium_total = ROUND((payment10_premium1 + payment10_premium2) Ã— 10 / 12)
- payment10_premium_total = (payment10_premium1 + payment10_premium2) Ã— 10
```

---

## ğŸ”„ ë³€ê²½ëœ API ë™ì‘

### kj-insurance-premium-data.php

#### ê¸°ë³¸ê°’ ê³„ì‚° (93-96ë²ˆ ë¼ì¸)
```php
// payment10_premium_totalì´ ì—†ìœ¼ë©´ ìë™ ê³„ì‚°
if ($payment10PremiumTotal === null && ($payment10Premium1 !== null || $payment10Premium2 !== null)) {
    $payment10PremiumTotal = (($payment10Premium1 ?? 0) + ($payment10Premium2 ?? 0)) * 10;
}
```

#### kj_premium_data ì¬ìƒì„± (147-172ë²ˆ ë¼ì¸)
- `monthly_premium1`, `monthly_premium2` í•„ë“œ ì¶”ê°€
- ê°ê° ê°œë³„ ê³„ì‚°í•˜ì—¬ ì €ì¥
- `monthly_premium_total`ì€ í•©ì‚° í›„ ê³„ì‚°

---

## ğŸ“Œ ì£¼ìš” í™•ì¸ ì‚¬í•­

### 1. í”„ë¡ íŠ¸ì—”ë“œ ê³„ì‚°ì‹ ê²€ì¦
- âœ… `(ë…„ê¸°ë³¸ + ë…„íŠ¹ì•½) Ã— 10 = ë…„ê³„` ê³µì‹ ì •í™•íˆ êµ¬í˜„
- âœ… ë…„ê¸°ë³¸ ì…ë ¥ ì‹œ ìë™ ê³„ì‚°
- âœ… ë…„íŠ¹ì•½ ì…ë ¥ ì‹œ ìë™ ê³„ì‚°
- âœ… ëª¨ë‹¬ ìƒˆë¡œê³ ì¹¨ ì‹œì—ë„ ë™ì¼í•˜ê²Œ ë™ì‘

### 2. ë°±ì—”ë“œ ê³„ì‚°ì‹ ê²€ì¦
- âœ… `kj_insurance_premium_data` ì €ì¥ ì‹œ ê¸°ë³¸ê°’ ê³„ì‚°ì‹ ë³€ê²½
- âœ… `kj_premium_data` ì¬ìƒì„± ì‹œ ëª¨ë“  ì›”ë³´í—˜ë£Œ í•„ë“œ ê³„ì‚°
- âœ… í”„ë¡ íŠ¸ì—”ë“œì™€ ë°±ì—”ë“œ ê³„ì‚°ì‹ ì¼ì¹˜

### 3. UI ê°œì„  ê²€ì¦
- âœ… í•„í„° ë ˆì´ë¸” ì œê±° í™•ì¸
- âœ… ì„ íƒë°•ìŠ¤ ê¸°ë³¸ê°’ ë³€ê²½ í™•ì¸
- âœ… ë©”ë‰´ ë ˆì´ë¸” ë³€ê²½ í™•ì¸

---

## ğŸ› í•´ê²°ëœ ì´ìŠˆ

### ì´ìŠˆ 1: ë³´í—˜ë£Œ ê³„ì‚°ì‹ ë¶ˆì¼ì¹˜
- **ì¦ìƒ**: í”„ë¡ íŠ¸ì—”ë“œì™€ ë°±ì—”ë“œ ê³„ì‚°ì‹ì´ ë‹¤ë¦„
- **ì›ì¸**: í”„ë¡ íŠ¸ì—”ë“œëŠ” `ë…„ê¸°ë³¸ Ã— 10`, ë°±ì—”ë“œëŠ” `ë…„ê¸°ë³¸ + ë…„íŠ¹ì•½` (Ã— 10 ì—†ìŒ)
- **í•´ê²°**: í”„ë¡ íŠ¸ì—”ë“œì™€ ë°±ì—”ë“œ ëª¨ë‘ `(ë…„ê¸°ë³¸ + ë…„íŠ¹ì•½) Ã— 10`ìœ¼ë¡œ í†µì¼

### ì´ìŠˆ 2: kj_premium_data ì¬ìƒì„± ì‹œ í•„ë“œ ëˆ„ë½
- **ì¦ìƒ**: `monthly_premium1`, `monthly_premium2` í•„ë“œê°€ ê³„ì‚°ë˜ì§€ ì•ŠìŒ
- **ì›ì¸**: ì¬ìƒì„± SQLì— í•´ë‹¹ í•„ë“œê°€ ì—†ìŒ
- **í•´ê²°**: INSERT ì¿¼ë¦¬ì— í•„ë“œ ì¶”ê°€ ë° ê³„ì‚°ì‹ ì ìš©

---

## ğŸ“ ì°¸ê³  ë¬¸ì„œ

- [ë³´í—˜ë£Œ ì…ë ¥ ë°©ì‹ ì„¤ëª…](./ë³´í—˜ë£Œ-ì…ë ¥-ë°©ì‹-ì„¤ëª….md)
- [KJ ëŒ€ë¦¬ìš´ì „ ì‹œìŠ¤í…œ ê°œìš”](./kj-ëŒ€ë¦¬ìš´ì „-ì‹œìŠ¤í…œ-ê°œìš”.md)
- [KJ ëŒ€ë¦¬ìš´ì „ ì—…ë¬´ í”Œë¡œìš°](./kj-ëŒ€ë¦¬ìš´ì „-ì—…ë¬´í”Œë¡œìš°.md)

---

## ğŸ”„ ë‹¤ìŒ ì‘ì—… ì˜ˆì •

### 1. ì¶”ê°€ ê²€ì¦ í•„ìš”
- [ ] ë³´í—˜ë£Œ ê³„ì‚° ê²°ê³¼ ì‹¤ì œ ë°ì´í„° ê²€ì¦
- [ ] kj_premium_data ì¬ìƒì„± í›„ ë°ì´í„° ì •í™•ì„± í™•ì¸
- [ ] ë‹¤ì–‘í•œ ì…ë ¥ ê°’ì— ëŒ€í•œ ê³„ì‚° ê²°ê³¼ ê²€ì¦

### 2. ê´€ë ¨ ê¸°ëŠ¥ í™•ì¸
- [ ] kj-premium-save.phpì—ì„œë„ ë™ì¼í•œ ê³„ì‚° ë¡œì§ ì ìš© ê²€í† 
- [ ] ë‹¤ë¥¸ ë³´í—˜ë£Œ ê´€ë ¨ APIì™€ì˜ ì¼ê´€ì„± í™•ì¸

---

**ì‘ì—… ì™„ë£Œ ì‹œê°„**: 2025-12-31  
**ì‘ì—… ìƒíƒœ**: ì™„ë£Œ âœ…

